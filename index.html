<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ServiçosPro | Controle de Serviços</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #6366f1;
            --primary-dark: #4f46e5;
            --primary-light: #818cf8;
            --dark: #1e293b;
            --light: #f8fafc;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --info: #3b82f6;
        }
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f1f5f9;
            color: var(--dark);
        }
        
        /* Glassmorphism effect */
        .glass-card {
            background: rgba(255, 255, 255, 0.85);
            backdrop-filter: blur(10px);
            -webkit-backdrop-filter: blur(10px);
            border-radius: 12px;
            border: 1px solid rgba(255, 255, 255, 0.18);
            box-shadow: 0 8px 32px 0 rgba(31, 38, 135, 0.1);
        }
        
        /* Sidebar */
        .sidebar {
            background: linear-gradient(180deg, var(--primary) 0%, var(--primary-dark) 100%);
            box-shadow: 4px 0 15px rgba(0, 0, 0, 0.1);
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            height: 100vh;
            overflow-y: auto;
        }
        
        .sidebar.collapsed {
            width: 80px;
        }
        
        .sidebar.collapsed .sidebar-text {
            opacity: 0;
            width: 0;
            height: 0;
            overflow: hidden;
        }
        
        .sidebar.collapsed .logo-text {
            opacity: 0;
            width: 0;
            height: 0;
            overflow: hidden;
        }
        
        .menu-item {
            transition: all 0.2s ease;
            border-radius: 8px;
        }
        
        .menu-item:hover {
            background: rgba(255, 255, 255, 0.15);
            transform: translateX(2px);
        }
        
        .menu-item.active {
            background: rgba(255, 255, 255, 0.2);
            font-weight: 500;
        }
        
        /* Main content */
        .main-content {
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
        }
        
        /* Cards */
        .stat-card {
            transition: all 0.3s ease;
            border-radius: 12px;
            overflow: hidden;
        }
        
        .stat-card:hover {
            transform: translateY(-3px);
            box-shadow: 0 10px 25px -5px rgba(0, 0, 0, 0.1);
        }
        
        /* Buttons */
        .btn-primary {
            background: var(--primary);
            transition: all 0.2s ease;
        }
        
        .btn-primary:hover {
            background: var(--primary-dark);
            transform: translateY(-1px);
        }
        
        /* Animations */
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .animate-fadeIn {
            animation: fadeIn 0.3s ease-out forwards;
        }
        
        /* Table styles */
        .data-table {
            border-radius: 12px;
            overflow: hidden;
        }
        
        .data-table th {
            background-color: #f8fafc;
            font-weight: 600;
            text-transform: uppercase;
            font-size: 0.75rem;
            letter-spacing: 0.05em;
        }
        
        .data-table tr {
            transition: background-color 0.2s ease;
        }
        
        .data-table tr:hover {
            background-color: #f8fafc;
        }
        
        /* Status badges */
        .badge {
            font-size: 0.75rem;
            font-weight: 500;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
        }
        
        .badge-pendente {
            background-color: #fef3c7;
            color: #92400e;
        }
        
        .badge-andamento {
            background-color: #dbeafe;
            color: #1e40af;
        }
        
        .badge-aguardando {
            background-color: #f3e8ff;
            color: #5b21b6;
        }
        
        .badge-concluido {
            background-color: #dcfce7;
            color: #166534;
        }
        
        /* Mobile footer */
        .mobile-footer {
            display: none;
            position: fixed;
            bottom: 0;
            left: 0;
            right: 0;
            background: white;
            box-shadow: 0 -4px 6px -1px rgba(0, 0, 0, 0.1);
            z-index: 50;
            height: 64px;
        }
        
        .mobile-footer-item {
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            color: #64748b;
            transition: all 0.2s ease;
        }
        
        .mobile-footer-item.active {
            color: var(--primary);
        }
        
        .mobile-footer-item i {
            font-size: 1.25rem;
            margin-bottom: 0.25rem;
        }
        
        .mobile-footer-item span {
            font-size: 0.75rem;
        }
        
        /* Responsive adjustments */
        @media (max-width: 768px) {
            .sidebar {
                display: none;
            }
            
            .mobile-footer {
                display: flex;
            }
            
            .main-content {
                margin-left: 0;
                padding-bottom: 80px;
            }
        }
        
        /* Print styles */
        .print-area {
            display: none;
        }
        
        @media print {
            body * {
                visibility: hidden;
            }
            
            .print-area, .print-area * {
                visibility: visible;
            }
            
            .print-area {
                position: absolute;
                left: 0;
                top: 0;
                width: 100%;
                display: block;
            }
            
            .no-print {
                display: none;
            }
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
            height: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #c7d2fe;
            border-radius: 10px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: var(--primary-light);
        }
        
        /* Loading spinner */
        .spinner {
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- App Container -->
    <div class="flex h-screen overflow-hidden">
        <!-- Sidebar (Desktop) -->
        <div class="sidebar fixed h-full text-white w-64 z-20 no-print flex-shrink-0" id="sidebar">
            <div class="p-6 flex items-center space-x-3 border-b border-white border-opacity-10">
                <div class="bg-white p-2 rounded-lg">
                    <i class="fas fa-tools text-indigo-600 text-xl"></i>
                </div>
                <span class="logo-text text-xl font-bold whitespace-nowrap">ServiçosPro</span>
            </div>
            
            <div class="p-4 space-y-1 mt-4">
                <div class="menu-item flex items-center space-x-3 p-3 cursor-pointer active" onclick="showSection('dashboard')">
                    <i class="fas fa-chart-line text-white text-opacity-80 w-6 text-center"></i>
                    <span class="sidebar-text font-medium">Dashboard</span>
                </div>
                <div class="menu-item flex items-center space-x-3 p-3 cursor-pointer" onclick="showSection('clientes')">
                    <i class="fas fa-users text-white text-opacity-80 w-6 text-center"></i>
                    <span class="sidebar-text font-medium">Clientes</span>
                </div>
                <div class="menu-item flex items-center space-x-3 p-3 cursor-pointer" onclick="showSection('servicos')">
                    <i class="fas fa-concierge-bell text-white text-opacity-80 w-6 text-center"></i>
                    <span class="sidebar-text font-medium">Serviços</span>
                </div>
                <div class="menu-item flex items-center space-x-3 p-3 cursor-pointer" onclick="showSection('orcamentos')">
                    <i class="fas fa-file-invoice-dollar text-white text-opacity-80 w-6 text-center"></i>
                    <span class="sidebar-text font-medium">Orçamentos</span>
                </div>
                <div class="menu-item flex items-center space-x-3 p-3 cursor-pointer" onclick="showSection('recibos')">
                    <i class="fas fa-receipt text-white text-opacity-80 w-6 text-center"></i>
                    <span class="sidebar-text font-medium">Recibos</span>
                </div>
                <div class="menu-item flex items-center space-x-3 p-3 cursor-pointer" onclick="showSection('historico')">
                    <i class="fas fa-history text-white text-opacity-80 w-6 text-center"></i>
                    <span class="sidebar-text font-medium">Histórico</span>
                </div>
            </div>
            
            <div class="absolute bottom-0 w-full p-4 border-t border-white border-opacity-10">
                <div class="menu-item flex items-center space-x-3 p-3 rounded cursor-pointer" onclick="toggleSidebar()">
                    <i class="fas fa-chevron-left text-white text-opacity-80 w-6 text-center"></i>
                    <span class="sidebar-text font-medium">Recolher Menu</span>
                </div>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content flex-1 overflow-auto ml-64" id="main-content">
            <!-- Top Navigation -->
            <div class="bg-white border-b border-gray-200 px-6 py-4 flex justify-between items-center sticky top-0 z-10">
                <div class="flex items-center space-x-4">
                    <button class="md:hidden text-gray-500" onclick="toggleMobileMenu()">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                    <h1 class="text-xl font-semibold text-gray-800" id="page-title">Dashboard</h1>
                </div>
                
                <div class="flex items-center space-x-4">
                    <div class="relative">
                        <button class="p-2 rounded-full hover:bg-gray-100">
                            <i class="fas fa-bell text-gray-500"></i>
                            <span class="absolute top-0 right-0 h-2 w-2 rounded-full bg-red-500"></span>
                        </button>
                    </div>
                    <div class="relative">
                        <button class="flex items-center space-x-2 focus:outline-none" id="user-menu-button">
                            <div class="h-8 w-8 rounded-full bg-indigo-100 flex items-center justify-center">
                                <span class="text-indigo-600 font-medium">US</span>
                            </div>
                            <span class="hidden md:inline text-sm font-medium">Usuário</span>
                            <i class="fas fa-chevron-down text-xs text-gray-500 hidden md:inline"></i>
                        </button>
                    </div>
                </div>
            </div>
            
            <!-- Dashboard Section -->
            <div id="dashboard-section" class="section p-6">
                <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6">
                    <div class="stat-card bg-white rounded-xl shadow-sm p-6 animate-fadeIn" style="animation-delay: 0.1s">
                        <div class="flex justify-between">
                            <div>
                                <p class="text-sm font-medium text-gray-500">Serviços Pendentes</p>
                                <h2 class="text-3xl font-bold mt-2" id="pendentes-count">0</h2>
                            </div>
                            <div class="h-12 w-12 rounded-lg bg-amber-100 flex items-center justify-center">
                                <i class="fas fa-clock text-amber-500 text-xl"></i>
                            </div>
                        </div>
                        <div class="mt-4">
                            <span class="text-sm text-gray-500"><span class="text-green-500 font-medium">+2.5%</span> vs último mês</span>
                        </div>
                    </div>
                    
                    <div class="stat-card bg-white rounded-xl shadow-sm p-6 animate-fadeIn" style="animation-delay: 0.2s">
                        <div class="flex justify-between">
                            <div>
                                <p class="text-sm font-medium text-gray-500">Em Andamento</p>
                                <h2 class="text-3xl font-bold mt-2" id="andamento-count">0</h2>
                            </div>
                            <div class="h-12 w-12 rounded-lg bg-blue-100 flex items-center justify-center">
                                <i class="fas fa-tools text-blue-500 text-xl"></i>
                            </div>
                        </div>
                        <div class="mt-4">
                            <span class="text-sm text-gray-500"><span class="text-green-500 font-medium">+5.1%</span> vs último mês</span>
                        </div>
                    </div>
                    
                    <div class="stat-card bg-white rounded-xl shadow-sm p-6 animate-fadeIn" style="animation-delay: 0.3s">
                        <div class="flex justify-between">
                            <div>
                                <p class="text-sm font-medium text-gray-500">Concluídos</p>
                                <h2 class="text-3xl font-bold mt-2" id="concluidos-count">0</h2>
                            </div>
                            <div class="h-12 w-12 rounded-lg bg-green-100 flex items-center justify-center">
                                <i class="fas fa-check-circle text-green-500 text-xl"></i>
                            </div>
                        </div>
                        <div class="mt-4">
                            <span class="text-sm text-gray-500"><span class="text-green-500 font-medium">+12.7%</span> vs último mês</span>
                        </div>
                    </div>
                    
                    <div class="stat-card bg-white rounded-xl shadow-sm p-6 animate-fadeIn" style="animation-delay: 0.4s">
                        <div class="flex justify-between">
                            <div>
                                <p class="text-sm font-medium text-gray-500">Receita Total</p>
                                <h2 class="text-3xl font-bold mt-2">R$ <span id="receita-total">0</span></h2>
                            </div>
                            <div class="h-12 w-12 rounded-lg bg-purple-100 flex items-center justify-center">
                                <i class="fas fa-dollar-sign text-purple-500 text-xl"></i>
                            </div>
                        </div>
                        <div class="mt-4">
                            <span class="text-sm text-gray-500"><span class="text-green-500 font-medium">+8.3%</span> vs último mês</span>
                        </div>
                    </div>
                </div>
                
                <div class="grid grid-cols-1 lg:grid-cols-3 gap-6 mb-6">
                    <div class="lg:col-span-2 glass-card p-6 animate-fadeIn" style="animation-delay: 0.5s">
                        <div class="flex justify-between items-center mb-6">
                            <h2 class="text-lg font-semibold">Atividades Recentes</h2>
                            <button class="text-sm text-indigo-600 hover:text-indigo-800">Ver tudo</button>
                        </div>
                        <div class="overflow-x-auto">
                            <table class="min-w-full data-table">
                                <thead>
                                    <tr>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Cliente</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Serviço</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                        <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Data</th>
                                    </tr>
                                </thead>
                                <tbody class="divide-y divide-gray-200" id="ultimos-servicos">
                                    <!-- Sample data -->
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap">João Silva</td>
                                        <td class="px-6 py-4 whitespace-nowrap">Reparo Notebook</td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="badge badge-andamento">Em Andamento</span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">15/06/2023</td>
                                    </tr>
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap">Maria Oliveira</td>
                                        <td class="px-6 py-4 whitespace-nowrap">Formatação PC</td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="badge badge-concluido">Concluído</span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">14/06/2023</td>
                                    </tr>
                                    <tr>
                                        <td class="px-6 py-4 whitespace-nowrap">Carlos Souza</td>
                                        <td class="px-6 py-4 whitespace-nowrap">Troca de Tela</td>
                                        <td class="px-6 py-4 whitespace-nowrap">
                                            <span class="badge badge-aguardando">Aguardando Peça</span>
                                        </td>
                                        <td class="px-6 py-4 whitespace-nowrap">13/06/2023</td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                    
                    <div class="glass-card p-6 animate-fadeIn" style="animation-delay: 0.6s">
                        <h2 class="text-lg font-semibold mb-6">Status dos Serviços</h2>
                        <div class="h-64 flex items-center justify-center">
                            <!-- Placeholder for chart -->
                            <div class="text-center text-gray-400">
                                <i class="fas fa-chart-pie text-4xl mb-2"></i>
                                <p>Gráfico de Status</p>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Clientes Section -->
            <div id="clientes-section" class="section hidden p-6">
                <div class="flex flex-col md:flex-row md:justify-between md:items-center mb-6">
                    <h1 class="text-2xl font-bold mb-4 md:mb-0">Clientes</h1>
                    <div class="flex space-x-3">
                        <div class="relative flex-1 md:w-64">
                            <input type="text" id="search-cliente" placeholder="Buscar cliente..." 
                                   class="w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                            <div class="absolute left-3 top-2.5 text-gray-400">
                                <i class="fas fa-search"></i>
                            </div>
                        </div>
                        <button onclick="showModal('cliente')" class="btn-primary text-white px-4 py-2 rounded-lg flex items-center space-x-2">
                            <i class="fas fa-plus"></i>
                            <span>Novo Cliente</span>
                        </button>
                    </div>
                </div>
                
                <div class="glass-card p-6">
                    <div class="overflow-x-auto">
                        <table class="min-w-full data-table">
                            <thead>
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Nome</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Telefone</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Email</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ações</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200" id="clientes-table">
                                <!-- Sample data -->
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="flex items-center">
                                            <div class="flex-shrink-0 h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center mr-3">
                                                <span class="text-indigo-600 font-medium">JS</span>
                                            </div>
                                            <div>
                                                <div class="font-medium">João Silva</div>
                                                <div class="text-gray-500 text-sm">CPF: 123.456.789-00</div>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">(11) 99999-9999</td>
                                    <td class="px-6 py-4 whitespace-nowrap">joao@email.com</td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="flex space-x-2">
                                            <button class="text-indigo-600 hover:text-indigo-900" title="Editar">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="text-red-600 hover:text-red-900" title="Excluir">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="flex items-center">
                                            <div class="flex-shrink-0 h-10 w-10 rounded-full bg-indigo-100 flex items-center justify-center mr-3">
                                                <span class="text-indigo-600 font-medium">MO</span>
                                            </div>
                                            <div>
                                                <div class="font-medium">Maria Oliveira</div>
                                                <div class="text-gray-500 text-sm">CPF: 987.654.321-00</div>
                                            </div>
                                        </div>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">(11) 98888-8888</td>
                                    <td class="px-6 py-4 whitespace-nowrap">maria@email.com</td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="flex space-x-2">
                                            <button class="text-indigo-600 hover:text-indigo-900" title="Editar">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="text-red-600 hover:text-red-900" title="Excluir">
                                                <i class="fas fa-trash"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="mt-6 flex items-center justify-between">
                        <div class="text-sm text-gray-500">
                            Mostrando <span class="font-medium">1</span> a <span class="font-medium">5</span> de <span class="font-medium">12</span> clientes
                        </div>
                        <div class="flex space-x-2">
                            <button class="px-3 py-1 border rounded-md text-gray-500 hover:bg-gray-50">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <button class="px-3 py-1 border rounded-md bg-indigo-600 text-white">
                                1
                            </button>
                            <button class="px-3 py-1 border rounded-md text-gray-500 hover:bg-gray-50">
                                2
                            </button>
                            <button class="px-3 py-1 border rounded-md text-gray-500 hover:bg-gray-50">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Serviços Section -->
            <div id="servicos-section" class="section hidden p-6">
                <div class="flex flex-col md:flex-row md:justify-between md:items-center mb-6">
                    <h1 class="text-2xl font-bold mb-4 md:mb-0">Serviços</h1>
                    <div class="flex space-x-3">
                        <div class="relative md:w-48">
                            <select id="filter-status" class="appearance-none w-full pl-3 pr-8 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                                <option value="all">Todos</option>
                                <option value="pendente">Pendentes</option>
                                <option value="andamento">Em Andamento</option>
                                <option value="aguardando">Aguardando Peça</option>
                                <option value="concluido">Concluídos</option>
                            </select>
                            <div class="absolute right-3 top-2.5 text-gray-400 pointer-events-none">
                                <i class="fas fa-chevron-down"></i>
                            </div>
                        </div>
                        <div class="relative flex-1 md:w-64">
                            <input type="text" id="search-servico" placeholder="Buscar serviço..." 
                                   class="w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                            <div class="absolute left-3 top-2.5 text-gray-400">
                                <i class="fas fa-search"></i>
                            </div>
                        </div>
                        <button onclick="showModal('servico')" class="btn-primary text-white px-4 py-2 rounded-lg flex items-center space-x-2">
                            <i class="fas fa-plus"></i>
                            <span>Novo Serviço</span>
                        </button>
                    </div>
                </div>
                
                <div class="glass-card p-6">
                    <div class="overflow-x-auto">
                        <table class="min-w-full data-table">
                            <thead>
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Cliente</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Descrição</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Valor</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ações</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200" id="servicos-table">
                                <!-- Sample data -->
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap">João Silva</td>
                                    <td class="px-6 py-4">Reparo no notebook Dell, troca de teclado</td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="badge badge-andamento">Em Andamento</span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">R$ 350,00</td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="flex space-x-2">
                                            <button class="text-indigo-600 hover:text-indigo-900" title="Editar">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="text-green-600 hover:text-green-900" title="Concluir">
                                                <i class="fas fa-check"></i>
                                            </button>
                                            <button class="text-red-600 hover:text-red-900" title="Cancelar">
                                                <i class="fas fa-times"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap">Maria Oliveira</td>
                                    <td class="px-6 py-4">Formatação e instalação de programas</td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="badge badge-concluido">Concluído</span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">R$ 120,00</td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="flex space-x-2">
                                            <button class="text-indigo-600 hover:text-indigo-900" title="Editar">
                                                <i class="fas fa-edit"></i>
                                            </button>
                                            <button class="text-blue-600 hover:text-blue-900" title="Gerar Recibo">
                                                <i class="fas fa-receipt"></i>
                                            </button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    
                    <div class="mt-6 flex items-center justify-between">
                        <div class="text-sm text-gray-500">
                            Mostrando <span class="font-medium">1</span> a <span class="font-medium">5</span> de <span class="font-medium">8</span> serviços
                        </div>
                        <div class="flex space-x-2">
                            <button class="px-3 py-1 border rounded-md text-gray-500 hover:bg-gray-50">
                                <i class="fas fa-chevron-left"></i>
                            </button>
                            <button class="px-3 py-1 border rounded-md bg-indigo-600 text-white">
                                1
                            </button>
                            <button class="px-3 py-1 border rounded-md text-gray-500 hover:bg-gray-50">
                                2
                            </button>
                            <button class="px-3 py-1 border rounded-md text-gray-500 hover:bg-gray-50">
                                <i class="fas fa-chevron-right"></i>
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <!-- Orçamentos Section -->
            <div id="orcamentos-section" class="section hidden p-6">
                <div class="flex flex-col md:flex-row md:justify-between md:items-center mb-6">
                    <h1 class="text-2xl font-bold mb-4 md:mb-0">Orçamentos</h1>
                    <div class="flex space-x-3">
                        <div class="relative flex-1 md:w-64">
                            <input type="text" id="search-orcamento" placeholder="Buscar orçamento..." 
                                   class="w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                            <div class="absolute left-3 top-2.5 text-gray-400">
                                <i class="fas fa-search"></i>
                            </div>
                        </div>
                        <button onclick="gerarOrcamento()" class="btn-primary text-white px-4 py-2 rounded-lg flex items-center space-x-2">
                            <i class="fas fa-plus"></i>
                            <span>Novo Orçamento</span>
                        </button>
                    </div>
                </div>
                
                <div class="glass-card p-6">
                    <div class="overflow-x-auto">
                        <table class="min-w-full data-table">
                            <thead>
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Cliente</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Serviço</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Valor</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Data</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ações</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200" id="orcamentos-table">
                                <!-- Sample data -->
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap">João Silva</td>
                                    <td class="px-6 py-4">Reparo no notebook Dell</td>
                                    <td class="px-6 py-4 whitespace-nowrap">R$ 350,00</td>
                                    <td class="px-6 py-4 whitespace-nowrap">10/06/2023</td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="flex space-x-2">
                                            <button onclick="visualizarOrcamento('${orcamento.id}')" class="text-blue-600 hover:text-blue-800 mr-2"><i class="fas fa-eye"></i></button>
                                            <button onclick="excluirOrcamento('${orcamento.id}')" class="text-red-600 hover:text-red-800"><i class="fas fa-trash"></i></button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Recibos Section -->
            <div id="recibos-section" class="section hidden p-6">
                <div class="flex flex-col md:flex-row md:justify-between md:items-center mb-6">
                    <h1 class="text-2xl font-bold mb-4 md:mb-0">Recibos</h1>
                    <div class="flex space-x-3">
                        <div class="relative flex-1 md:w-64">
                            <input type="text" id="search-recibo" placeholder="Buscar recibo..." 
                                   class="w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                            <div class="absolute left-3 top-2.5 text-gray-400">
                                <i class="fas fa-search"></i>
                            </div>
                        </div>
                        <button onclick="gerarRecibo()" class="btn-primary text-white px-4 py-2 rounded-lg flex items-center space-x-2">
                            <i class="fas fa-plus"></i>
                            <span>Novo Recibo</span>
                        </button>
                    </div>
                </div>
                
                <div class="glass-card p-6">
                    <div class="overflow-x-auto">
                        <table class="min-w-full data-table">
                            <thead>
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Cliente</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Serviço</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Valor</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Data</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ações</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200" id="recibos-table">
                                <!-- Sample data -->
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap">Maria Oliveira</td>
                                    <td class="px-6 py-4">Formatação e instalação de programas</td>
                                    <td class="px-6 py-4 whitespace-nowrap">R$ 120,00</td>
                                    <td class="px-6 py-4 whitespace-nowrap">12/06/2023</td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="flex space-x-2">
                                            <button onclick="visualizarRecibo('${recibo.id}')" class="text-blue-600 hover:text-blue-800 mr-2"><i class="fas fa-eye"></i></button>
                                            <button onclick="excluirRecibo('${recibo.id}')" class="text-red-600 hover:text-red-800"><i class="fas fa-trash"></i></button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
            
            <!-- Histórico Section -->
            <div id="historico-section" class="section hidden p-6">
                <div class="flex flex-col md:flex-row md:justify-between md:items-center mb-6">
                    <h1 class="text-2xl font-bold mb-4 md:mb-0">Histórico de Serviços</h1>
                    <div class="flex space-x-3">
                        <div class="relative md:w-48">
                            <select id="filter-historico" class="appearance-none w-full pl-3 pr-8 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                                <option value="all">Todos</option>
                                <option value="pendente">Pendentes</option>
                                <option value="andamento">Em Andamento</option>
                                <option value="aguardando">Aguardando Peça</option>
                                <option value="concluido">Concluídos</option>
                            </select>
                            <div class="absolute right-3 top-2.5 text-gray-400 pointer-events-none">
                                <i class="fas fa-chevron-down"></i>
                            </div>
                        </div>
                        <div class="relative flex-1 md:w-64">
                            <input type="text" id="search-historico" placeholder="Buscar no histórico..." 
                                   class="w-full pl-10 pr-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                            <div class="absolute left-3 top-2.5 text-gray-400">
                                <i class="fas fa-search"></i>
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="glass-card p-6">
                    <div class="overflow-x-auto">
                        <table class="min-w-full data-table">
                            <thead>
                                <tr>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Cliente</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Serviço</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Status</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Valor</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Data</th>
                                    <th class="px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider">Ações</th>
                                </tr>
                            </thead>
                            <tbody class="divide-y divide-gray-200" id="historico-table">
                                <!-- Sample data -->
                                <tr>
                                    <td class="px-6 py-4 whitespace-nowrap">João Silva</td>
                                    <td class="px-6 py-4">Reparo no notebook Dell</td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <span class="badge badge-concluido">Concluído</span>
                                    </td>
                                    <td class="px-6 py-4 whitespace-nowrap">R$ 350,00</td>
                                    <td class="px-6 py-4 whitespace-nowrap">10/06/2023</td>
                                    <td class="px-6 py-4 whitespace-nowrap">
                                        <div class="flex space-x-2">
                                            <button onclick="detalhesServico('${servico.id}')" class="text-indigo-600 hover:text-indigo-800 mr-2"><i class="fas fa-info-circle"></i></button>
                                            <button onclick="reciboServico('${servico.id}')" class="text-blue-600 hover:text-blue-800 mr-2"><i class="fas fa-receipt"></i></button>
                                        </div>
                                    </td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Mobile Footer (Celular) -->
    <div class="mobile-footer no-print" id="mobile-footer">
        <div class="mobile-footer-item active" onclick="showSection('dashboard')">
            <i class="fas fa-chart-line"></i>
            <span>Dashboard</span>
        </div>
        <div class="mobile-footer-item" onclick="showSection('clientes')">
            <i class="fas fa-users"></i>
            <span>Clientes</span>
        </div>
        <div class="mobile-footer-item" onclick="showSection('servicos')">
            <i class="fas fa-concierge-bell"></i>
            <span>Serviços</span>
        </div>
        <div class="mobile-footer-item" onclick="showSection('orcamentos')">
            <i class="fas fa-file-invoice-dollar"></i>
            <span>Orçamentos</span>
        </div>
        <div class="mobile-footer-item" onclick="showSection('recibos')">
            <i class="fas fa-receipt"></i>
            <span>Recibos</span>
        </div>
    </div>
    
    <!-- Modal Cliente -->
    <div id="cliente-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-30 hidden">
        <div class="bg-white rounded-xl shadow-xl w-full max-w-md mx-4 animate-fadeIn">
            <div class="flex justify-between items-center p-6 border-b">
                <h2 class="text-xl font-bold" id="cliente-modal-title">Novo Cliente</h2>
                <button onclick="hideModal('cliente')" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <form id="cliente-form" class="p-6">
                <input type="hidden" id="cliente-id">
                <div class="space-y-4">
                    <div>
                        <label for="cliente-nome" class="block text-sm font-medium text-gray-700 mb-1">Nome</label>
                        <input type="text" id="cliente-nome" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" required>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="cliente-telefone" class="block text-sm font-medium text-gray-700 mb-1">Telefone</label>
                            <input type="text" id="cliente-telefone" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                        </div>
                        <div>
                            <label for="cliente-email" class="block text-sm font-medium text-gray-700 mb-1">Email</label>
                            <input type="email" id="cliente-email" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                        </div>
                    </div>
                    <div>
                        <label for="cliente-cpf" class="block text-sm font-medium text-gray-700 mb-1">CPF</label>
                        <input type="text" id="cliente-cpf" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                    </div>
                    <div>
                        <label for="cliente-endereco" class="block text-sm font-medium text-gray-700 mb-1">Endereço</label>
                        <textarea id="cliente-endereco" rows="3" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"></textarea>
                    </div>
                </div>
                <div class="mt-6 flex justify-end space-x-3">
                    <button type="button" onclick="hideModal('cliente')" class="px-4 py-2 border rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500">
                        Cancelar
                    </button>
                    <button type="submit" class="btn-primary text-white px-4 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        Salvar Cliente
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Modal Serviço -->
    <div id="servico-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-30 hidden">
        <div class="bg-white rounded-xl shadow-xl w-full max-w-md mx-4 animate-fadeIn">
            <div class="flex justify-between items-center p-6 border-b">
                <h2 class="text-xl font-bold" id="servico-modal-title">Novo Serviço</h2>
                <button onclick="hideModal('servico')" class="text-gray-500 hover:text-gray-700">
                    <i class="fas fa-times text-xl"></i>
                </button>
            </div>
            <form id="servico-form" class="p-6">
                <input type="hidden" id="servico-id">
                <div class="space-y-4">
                    <div>
                        <label for="servico-cliente" class="block text-sm font-medium text-gray-700 mb-1">Cliente</label>
                        <select id="servico-cliente" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" required>
                            <option value="">Selecione um cliente</option>
                            <!-- Clientes serão carregados aqui -->
                            <option value="1">João Silva</option>
                            <option value="2">Maria Oliveira</option>
                        </select>
                    </div>
                    <div>
                        <label for="servico-descricao" class="block text-sm font-medium text-gray-700 mb-1">Descrição</label>
                        <textarea id="servico-descricao" rows="3" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" required></textarea>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                        <div>
                            <label for="servico-valor" class="block text-sm font-medium text-gray-700 mb-1">Valor (R$)</label>
                            <input type="number" step="0.01" id="servico-valor" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500">
                        </div>
                        <div>
                            <label for="servico-status" class="block text-sm font-medium text-gray-700 mb-1">Status</label>
                            <select id="servico-status" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" required>
                                <option value="pendente">Pendente</option>
                                <option value="andamento">Em Andamento</option>
                                <option value="aguardando">Aguardando Peça</option>
                                <option value="concluido">Concluído</option>
                            </select>
                        </div>
                    </div>
                    <div>
                        <label for="servico-observacoes" class="block text-sm font-medium text-gray-700 mb-1">Observações</label>
                        <textarea id="servico-observacoes" rows="2" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500"></textarea>
                    </div>
                </div>
                <div class="mt-6 flex justify-end space-x-3">
                    <button type="button" onclick="hideModal('servico')" class="px-4 py-2 border rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500">
                        Cancelar
                    </button>
                    <button type="submit" class="btn-primary text-white px-4 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        Salvar Serviço
                    </button>
                </div>
            </form>
        </div>
    </div>
    
    <!-- Modal Orçamento -->
    <div id="orcamento-modal" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-30 hidden">
        <div class="bg-white rounded-xl shadow-xl w-full max-w-2xl mx-4 animate-fadeIn">
            <div class="flex justify-between items-center p-6 border-b">
                <h2 class="text-xl font-bold">Novo Orçamento</h2>
                <div class="flex space-x-3">
                    <button onclick="imprimirOrcamento()" class="p-2 rounded-lg hover:bg-gray-100">
                        <i class="fas fa-print text-gray-600"></i>
                    </button>
                    <button onclick="hideModal('orcamento')" class="text-gray-500 hover:text-gray-700">
                        <i class="fas fa-times text-xl"></i>
                    </button>
                </div>
            </div>
            <div class="p-6">
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                    <div>
                        <label for="orcamento-cliente" class="block text-sm font-medium text-gray-700 mb-1">Cliente</label>
                        <select id="orcamento-cliente" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" required>
                            <option value="">Selecione um cliente</option>
                            <!-- Clientes serão carregados aqui -->
                            <option value="1">João Silva</option>
                            <option value="2">Maria Oliveira</option>
                        </select>
                    </div>
                    <div>
                        <label for="orcamento-servico" class="block text-sm font-medium text-gray-700 mb-1">Serviço</label>
                        <select id="orcamento-servico" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" required>
                            <option value="">Selecione um serviço</option>
                            <!-- Serviços serão carregados aqui -->
                            <option value="1">Reparo Notebook</option>
                            <option value="2">Formatação PC</option>
                        </select>
                    </div>
                    <div>
                        <label for="orcamento-valor" class="block text-sm font-medium text-gray-700 mb-1">Valor (R$)</label>
                        <input type="number" step="0.01" id="orcamento-valor" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" required>
                    </div>
                    <div>
                        <label for="orcamento-validade" class="block text-sm font-medium text-gray-700 mb-1">Validade (dias)</label>
                        <input type="number" id="orcamento-validade" class="w-full px-4 py-2 border rounded-lg focus:ring-2 focus:ring-indigo-500 focus:border-indigo-500" value="7">
                    </div>
                </div>
                
                <div class="flex justify-end space-x-3">
                    <button type="button" onclick="hideModal('orcamento')" class="px-4 py-2 border rounded-lg hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-gray-500">
                        Cancelar
                    </button>
                    <button type="button" onclick="salvarOrcamento()" class="btn-primary text-white px-4 py-2 rounded-lg focus:outline-none focus:ring-2 focus:ring-indigo-500">
                        Salvar Orçamento
                    </button>
                </div>
                
                <!-- Área de impressão do orçamento -->
                <div id="orcamento-print" class="print-area mt-8 p-6 border rounded-lg hidden">
                    <div class="text-center mb-8">
                        <h2 class="text-2xl font-bold">ORÇAMENTO</h2>
                        <p class="text-gray-600">Nº: <span id="orcamento-numero-print">0001</span></p>
                    </div>
                    <div class="mb-6 grid grid-cols-1 md:grid-cols-2 gap-6">
                        <div>
                            <p class="font-medium text-gray-700">Cliente:</p>
                            <p id="orcamento-cliente-print">Nome do Cliente</p>
                        </div>
                        <div>
                            <p class="font-medium text-gray-700">Data:</p>
                            <p id="orcamento-data-print">01/01/2023</p>
                        </div>
                    </div>
                    <div class="mb-6">
                        <p class="font-medium text-gray-700">Serviço:</p>
                        <p id="orcamento-servico-print">Descrição do serviço a ser realizado</p>
                    </div>
                    <div class="mb-6">
                        <p class="font-medium text-gray-700">Valor:</p>
                        <p id="orcamento-valor-print">R$ 0,00</p>
                    </div>
                    <div class="mb-6">
                        <p class="font-medium text-gray-700">Validade:</p>
                        <p id="orcamento-validade-print">7 dias</p>
                    </div>
                    <div class="mt-12 pt-6 border-t text-center">
                        <p>Assinatura do Cliente</p>
                        <div class="h-16 mt-4 border-b"></div>
                        <p class="mt-2 text-sm text-gray-500">Nome e CPF</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Loading Overlay -->
    <div id="loading-overlay" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-40 hidden">
        <div class="bg-white rounded-xl p-6 flex flex-col items-center">
            <div class="h-12 w-12 rounded-full border-4 border-indigo-500 border-t-transparent animate-spin mb-4"></div>
            <p class="text-gray-700">Carregando...</p>
        </div>
    </div>

    <!-- Supabase Configuration -->
    <script>
        // Configuração do Supabase
        const supabaseUrl = 'https://bnyhgginbhsjeilcclzf.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImJueWhnZ2luYmhzamVpbGNjbHpmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NDg4ODc2MTUsImV4cCI6MjA2NDQ2MzYxNX0.TnW7d8rcCIDuFOszn-wad2rs40QJqKhrplEye0qXAVA';
        const supabase = window.supabase.createClient(supabaseUrl, supabaseKey);
        
        // Variáveis globais
        let clientes = [];
        let servicos = [];
        let orcamentos = [];
        let recibos = [];

        // Funções para carregar dados do Supabase
        async function carregarClientes() {
            try {
                const { data, error } = await supabase
                    .from('clientes')
                    .select('*')
                    .order('nome', { ascending: true });
                if (error) throw error;
                clientes = data || [];
                renderizarClientes();
                atualizarSelectClientes();
            } catch (error) {
                console.error('Erro ao carregar clientes:', error);
                alert('Erro ao carregar clientes');
            }
        }

        async function carregarServicos() {
            try {
                const { data, error } = await supabase
                    .from('servicos')
                    .select('*, clientes(nome)')
                    .order('created_at', { ascending: false });
                if (error) throw error;
                servicos = data || [];
                renderizarServicos();
                atualizarDashboard();
                atualizarSelectServicos();
            } catch (error) {
                console.error('Erro ao carregar serviços:', error);
                alert('Erro ao carregar serviços');
            }
        }

        // Renderização das tabelas
        function renderizarClientes() {
            const tbody = document.getElementById('clientes-table');
            if (!tbody) return;
            tbody.innerHTML = '';
            if (clientes.length === 0) {
                tbody.innerHTML = '<tr><td colspan="4" class="py-4 text-center text-gray-500">Nenhum cliente cadastrado</td></tr>';
                return;
            }
            clientes.forEach(cliente => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">${cliente.nome}</td>
                    <td class="px-6 py-4 whitespace-nowrap">${cliente.telefone || '-'}</td>
                    <td class="px-6 py-4 whitespace-nowrap">${cliente.email || '-'}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <button onclick="editarCliente('${cliente.id}')" class="text-blue-600 hover:text-blue-800 mr-2"><i class="fas fa-edit"></i></button>
                        <button onclick="excluirCliente('${cliente.id}')" class="text-red-600 hover:text-red-800"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function renderizarServicos() {
            const tbody = document.getElementById('servicos-table');
            if (!tbody) return;
            tbody.innerHTML = '';
            if (servicos.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="py-4 text-center text-gray-500">Nenhum serviço cadastrado</td></tr>';
                return;
            }
            servicos.forEach(servico => {
                const statusClass = {
                    'pendente': 'badge badge-pendente',
                    'andamento': 'badge badge-andamento',
                    'aguardando': 'badge badge-aguardando',
                    'concluido': 'badge badge-concluido'
                }[servico.status] || 'badge';
                const statusText = {
                    'pendente': 'Pendente',
                    'andamento': 'Em Andamento',
                    'aguardando': 'Aguardando Peça',
                    'concluido': 'Concluído'
                }[servico.status] || 'Desconhecido';
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">${servico.clientes?.nome || 'Cliente não encontrado'}</td>
                    <td class="px-6 py-4">${servico.descricao}</td>
                    <td class="px-6 py-4 whitespace-nowrap"><span class="${statusClass}">${statusText}</span></td>
                    <td class="px-6 py-4 whitespace-nowrap">R$ ${servico.valor ? parseFloat(servico.valor).toFixed(2).replace('.', ',') : '-'}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <button onclick="editarServico('${servico.id}')" class="text-blue-600 hover:text-blue-800 mr-2"><i class="fas fa-edit"></i></button>
                        <button onclick="excluirServico('${servico.id}')" class="text-red-600 hover:text-red-800"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        // Atualizar selects de clientes e serviços
        function atualizarSelectClientes() {
            const selects = document.querySelectorAll('select[id$="-cliente"]');
            selects.forEach(select => {
                const currentValue = select.value;
                select.innerHTML = '<option value="">Selecione um cliente</option>';
                clientes.forEach(cliente => {
                    const option = document.createElement('option');
                    option.value = cliente.id;
                    option.textContent = cliente.nome;
                    select.appendChild(option);
                });
                if (currentValue) select.value = currentValue;
            });
        }
        function atualizarSelectServicos() {
            const selects = document.querySelectorAll('select[id$="-servico"]');
            selects.forEach(select => {
                const currentValue = select.value;
                select.innerHTML = '<option value="">Selecione um serviço</option>';
                servicos.forEach(servico => {
                    const option = document.createElement('option');
                    option.value = servico.id;
                    option.textContent = `${servico.descricao} - R$ ${parseFloat(servico.valor).toFixed(2).replace('.', ',')}`;
                    select.appendChild(option);
                });
                if (currentValue) select.value = currentValue;
            });
        }

        // CRUD Clientes
        async function salvarCliente(e) {
            e.preventDefault();
            const id = document.getElementById('cliente-id').value;
            const nome = document.getElementById('cliente-nome').value;
            const telefone = document.getElementById('cliente-telefone').value;
            const email = document.getElementById('cliente-email').value;
            const endereco = document.getElementById('cliente-endereco').value;
            if (!nome || nome.trim() === '') {
                alert('O nome do cliente é obrigatório');
                return;
            }
            try {
                if (id) {
                    const { error } = await supabase
                        .from('clientes')
                        .update({ nome, telefone, email, endereco })
                        .eq('id', id);
                    if (error) throw error;
                    alert('Cliente atualizado com sucesso!');
                } else {
                    const { error } = await supabase
                        .from('clientes')
                        .insert([{ nome, telefone, email, endereco }]);
                    if (error) throw error;
                    alert('Cliente cadastrado com sucesso!');
                }
                hideModal('cliente');
                carregarClientes();
            } catch (error) {
                console.error('Erro ao salvar cliente:', error);
                alert('Erro ao salvar cliente');
            }
        }
        async function editarCliente(id) {
            const cliente = clientes.find(c => c.id == id);
            if (cliente) {
                document.getElementById('cliente-modal-title').textContent = 'Editar Cliente';
                document.getElementById('cliente-id').value = cliente.id;
                document.getElementById('cliente-nome').value = cliente.nome;
                document.getElementById('cliente-telefone').value = cliente.telefone || '';
                document.getElementById('cliente-email').value = cliente.email || '';
                document.getElementById('cliente-endereco').value = cliente.endereco || '';
                showModal('cliente');
            }
        }
        async function excluirCliente(id) {
            if (!confirm('Tem certeza que deseja excluir este cliente?')) return;
            try {
                // Verificar se o cliente tem serviços associados
                const { data: servicosCliente, error: errorServicos } = await supabase
                    .from('servicos')
                    .select('id')
                    .eq('cliente_id', id);
                if (errorServicos) throw errorServicos;
                if (servicosCliente.length > 0) {
                    alert('Este cliente possui serviços associados e não pode ser excluído.');
                    return;
                }
                const { error } = await supabase
                    .from('clientes')
                    .delete()
                    .eq('id', id);
                if (error) throw error;
                alert('Cliente excluído com sucesso!');
                carregarClientes();
            } catch (error) {
                console.error('Erro ao excluir cliente:', error);
                alert('Erro ao excluir cliente');
            }
        }

        // CRUD Serviços
        async function salvarServico(e) {
            e.preventDefault();
            const id = document.getElementById('servico-id').value;
            const cliente_id = document.getElementById('servico-cliente').value;
            const descricao = document.getElementById('servico-descricao').value;
            const valor = document.getElementById('servico-valor').value;
            const status = document.getElementById('servico-status').value;
            const observacoes = document.getElementById('servico-observacoes').value;
            if (!cliente_id || !descricao || !valor) {
                alert('Preencha todos os campos obrigatórios');
                return;
            }
            try {
                if (id) {
                    const { error } = await supabase
                        .from('servicos')
                        .update({ cliente_id, descricao, valor, status, observacoes })
                        .eq('id', id);
                    if (error) throw error;
                    alert('Serviço atualizado com sucesso!');
                } else {
                    const { error } = await supabase
                        .from('servicos')
                        .insert([{ cliente_id, descricao, valor, status, observacoes }]);
                    if (error) throw error;
                    alert('Serviço cadastrado com sucesso!');
                }
                hideModal('servico');
                carregarServicos();
            } catch (error) {
                console.error('Erro ao salvar serviço:', error);
                alert('Erro ao salvar serviço');
            }
        }
        async function editarServico(id) {
            const servico = servicos.find(s => s.id == id);
            if (servico) {
                document.getElementById('servico-modal-title').textContent = 'Editar Serviço';
                document.getElementById('servico-id').value = servico.id;
                document.getElementById('servico-cliente').value = servico.cliente_id;
                document.getElementById('servico-descricao').value = servico.descricao;
                document.getElementById('servico-valor').value = servico.valor || '';
                document.getElementById('servico-status').value = servico.status;
                document.getElementById('servico-observacoes').value = servico.observacoes || '';
                showModal('servico');
            }
        }
        async function excluirServico(id) {
            if (!confirm('Tem certeza que deseja excluir este serviço?')) return;
            try {
                const { error } = await supabase
                    .from('servicos')
                    .delete()
                    .eq('id', id);
                if (error) throw error;
                alert('Serviço excluído com sucesso!');
                carregarServicos();
            } catch (error) {
                console.error('Erro ao excluir serviço:', error);
                alert('Erro ao excluir serviço');
            }
        }

        // Atualizar dashboard
        function atualizarDashboard() {
            try {
                const pendentes = servicos.filter(s => s.status === 'pendente').length;
                const andamento = servicos.filter(s => s.status === 'andamento').length;
                const concluidos = servicos.filter(s => s.status === 'concluido').length;
                document.getElementById('pendentes-count').textContent = pendentes;
                document.getElementById('andamento-count').textContent = andamento;
                document.getElementById('concluidos-count').textContent = concluidos;
            } catch (error) {
                console.error('Erro ao atualizar dashboard:', error);
            }
        }

        // Funções para carregar dados do Supabase (continuação)
        async function carregarOrcamentos() {
            try {
                const { data, error } = await supabase
                    .from('orcamentos')
                    .select('*, clientes(nome), servicos(descricao)')
                    .order('created_at', { ascending: false });
                if (error) throw error;
                orcamentos = data || [];
                renderizarOrcamentos();
            } catch (error) {
                console.error('Erro ao carregar orçamentos:', error);
                alert('Erro ao carregar orçamentos');
            }
        }
        async function carregarRecibos() {
            try {
                const { data, error } = await supabase
                    .from('recibos')
                    .select('*, clientes(nome), servicos(descricao)')
                    .order('created_at', { ascending: false });
                if (error) throw error;
                recibos = data || [];
                renderizarRecibos();
            } catch (error) {
                console.error('Erro ao carregar recibos:', error);
                alert('Erro ao carregar recibos');
            }
        }
        // Renderização das tabelas de orçamentos e recibos
        function renderizarOrcamentos() {
            const tbody = document.getElementById('orcamentos-table');
            if (!tbody) return;
            tbody.innerHTML = '';
            if (orcamentos.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="py-4 text-center text-gray-500">Nenhum orçamento cadastrado</td></tr>';
                return;
            }
            orcamentos.forEach(orcamento => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">${orcamento.clientes?.nome || '-'}</td>
                    <td class="px-6 py-4">${orcamento.servicos?.descricao || '-'}</td>
                    <td class="px-6 py-4 whitespace-nowrap">R$ ${parseFloat(orcamento.valor).toFixed(2).replace('.', ',')}</td>
                    <td class="px-6 py-4 whitespace-nowrap">${new Date(orcamento.created_at).toLocaleDateString('pt-BR')}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <button onclick="visualizarOrcamento('${orcamento.id}')" class="text-blue-600 hover:text-blue-800 mr-2"><i class="fas fa-eye"></i></button>
                        <button onclick="excluirOrcamento('${orcamento.id}')" class="text-red-600 hover:text-red-800"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }
        function renderizarRecibos() {
            const tbody = document.getElementById('recibos-table');
            if (!tbody) return;
            tbody.innerHTML = '';
            if (recibos.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="py-4 text-center text-gray-500">Nenhum recibo cadastrado</td></tr>';
                return;
            }
            recibos.forEach(recibo => {
                const tr = document.createElement('tr');
                tr.innerHTML = `
                    <td class="px-6 py-4 whitespace-nowrap">${recibo.clientes?.nome || '-'}</td>
                    <td class="px-6 py-4">${recibo.servicos?.descricao || '-'}</td>
                    <td class="px-6 py-4 whitespace-nowrap">R$ ${parseFloat(recibo.valor).toFixed(2).replace('.', ',')}</td>
                    <td class="px-6 py-4 whitespace-nowrap">${new Date(recibo.created_at).toLocaleDateString('pt-BR')}</td>
                    <td class="px-6 py-4 whitespace-nowrap">
                        <button onclick="visualizarRecibo('${recibo.id}')" class="text-blue-600 hover:text-blue-800 mr-2"><i class="fas fa-eye"></i></button>
                        <button onclick="excluirRecibo('${recibo.id}')" class="text-red-600 hover:text-red-800"><i class="fas fa-trash"></i></button>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }
        // CRUD Orçamentos
        async function salvarOrcamento() {
            const cliente_id = document.getElementById('orcamento-cliente').value;
            const servico_id = document.getElementById('orcamento-servico').value;
            const valor = document.getElementById('orcamento-valor').value;
            const validade = document.getElementById('orcamento-validade').value;
            if (!cliente_id || !servico_id || !valor) {
                alert('Preencha todos os campos obrigatórios');
                return;
            }
            try {
                const { error } = await supabase
                    .from('orcamentos')
                    .insert([{ cliente_id, servico_id, valor, validade }]);
                if (error) throw error;
                alert('Orçamento salvo com sucesso!');
                hideModal('orcamento');
                carregarOrcamentos();
            } catch (error) {
                console.error('Erro ao salvar orçamento:', error);
                alert('Erro ao salvar orçamento');
            }
        }
        async function excluirOrcamento(id) {
            if (!confirm('Tem certeza que deseja excluir este orçamento?')) return;
            try {
                const { error } = await supabase
                    .from('orcamentos')
                    .delete()
                    .eq('id', id);
                if (error) throw error;
                alert('Orçamento excluído com sucesso!');
                carregarOrcamentos();
            } catch (error) {
                console.error('Erro ao excluir orçamento:', error);
                alert('Erro ao excluir orçamento');
            }
        }
        async function visualizarOrcamento(id) {
            try {
                const { data, error } = await supabase
                    .from('orcamentos')
                    .select('*, clientes(*), servicos(*)')
                    .eq('id', id)
                    .single();
                if (error) throw error;
                if (!data) {
                    alert('Orçamento não encontrado!');
                    return;
                }
                document.getElementById('orcamento-modal').classList.remove('hidden');
                document.getElementById('orcamento-print').classList.remove('hidden');
                document.getElementById('orcamento-numero-print').textContent = 'ORC' + new Date(data.created_at).getTime().toString().slice(-6);
                document.getElementById('orcamento-cliente-print').textContent = data.clientes?.nome || 'Cliente não encontrado';
                document.getElementById('orcamento-data-print').textContent = new Date(data.created_at).toLocaleDateString();
                document.getElementById('orcamento-validade-print').textContent = data.validade + ' dias';
                document.getElementById('orcamento-descricao-print').textContent = data.servicos?.descricao || 'Serviço não encontrado';
                document.getElementById('orcamento-valor-print').textContent = 'R$ ' + parseFloat(data.valor).toFixed(2);
                document.getElementById('orcamento-observacoes-print').textContent = data.observacoes || 'Orçamento válido por ' + data.validade + ' dias.';
                carregarClientesNoSelect('orcamento-cliente');
                carregarServicosNoSelect('orcamento-servico');
                setTimeout(() => {
                    document.getElementById('orcamento-cliente').value = data.cliente_id;
                    document.getElementById('orcamento-servico').value = data.servico_id;
                    document.getElementById('orcamento-valor').value = data.valor;
                    document.getElementById('orcamento-validade').value = data.validade || 7;
                }, 500);
            } catch (error) {
                console.error('Erro ao visualizar orçamento:', error);
                alert('Erro ao visualizar orçamento');
            }
        }
        // CRUD Recibos
        async function salvarRecibo() {
            const cliente_id = document.getElementById('recibo-cliente').value;
            const servico_id = document.getElementById('recibo-servico').value;
            const valor = document.getElementById('recibo-valor').value;
            const forma_pagamento = document.getElementById('recibo-forma-pagamento').value;
            if (!cliente_id || !servico_id || !valor) {
                alert('Preencha todos os campos obrigatórios');
                return;
            }
            try {
                const { error } = await supabase
                    .from('recibos')
                    .insert([{ cliente_id, servico_id, valor, forma_pagamento }]);
                if (error) throw error;
                alert('Recibo salvo com sucesso!');
                hideModal('recibo');
                carregarRecibos();
            } catch (error) {
                console.error('Erro ao salvar recibo:', error);
                alert('Erro ao salvar recibo');
            }
        }
        async function excluirRecibo(id) {
            if (!confirm('Tem certeza que deseja excluir este recibo?')) return;
            try {
                const { error } = await supabase
                    .from('recibos')
                    .delete()
                    .eq('id', id);
                if (error) throw error;
                alert('Recibo excluído com sucesso!');
                carregarRecibos();
            } catch (error) {
                console.error('Erro ao excluir recibo:', error);
                alert('Erro ao excluir recibo');
            }
        }
        async function visualizarRecibo(id) {
            try {
                const { data, error } = await supabase
                    .from('recibos')
                    .select('*, clientes(*), servicos(*)')
                    .eq('id', id)
                    .single();
                if (error) throw error;
                if (!data) {
                    alert('Recibo não encontrado!');
                    return;
                }
                document.getElementById('recibo-modal').classList.remove('hidden');
                document.getElementById('recibo-print').classList.remove('hidden');
                document.getElementById('recibo-numero-print').textContent = 'REC' + new Date(data.created_at).getTime().toString().slice(-6);
                document.getElementById('recibo-cliente-print').textContent = data.clientes?.nome || 'Cliente não encontrado';
                document.getElementById('recibo-descricao-print').textContent = data.servicos?.descricao || 'Serviço não encontrado';
                document.getElementById('recibo-valor-extenso-print').textContent = valorParaExtenso ? valorParaExtenso(data.valor) : (parseFloat(data.valor).toFixed(2) + ' reais');
                document.getElementById('recibo-forma-pagamento-print').textContent = data.forma_pagamento || 'Não informado';
                document.getElementById('recibo-data-print').textContent = new Date(data.created_at).toLocaleDateString();
                carregarClientesNoSelect('recibo-cliente');
                carregarServicosNoSelect('recibo-servico');
                setTimeout(() => {
                    document.getElementById('recibo-cliente').value = data.cliente_id;
                    document.getElementById('recibo-servico').value = data.servico_id;
                    document.getElementById('recibo-valor').value = data.valor;
                    document.getElementById('recibo-forma-pagamento').value = data.forma_pagamento || 'Dinheiro';
                }, 500);
            } catch (error) {
                console.error('Erro ao visualizar recibo:', error);
                alert('Erro ao visualizar recibo');
            }
        }
        // Inicialização extra para orçamentos e recibos
        document.addEventListener('DOMContentLoaded', function() {
            carregarOrcamentos();
            carregarRecibos();
        });

        // Formulários
        document.getElementById('cliente-form').addEventListener('submit', salvarCliente);
        document.getElementById('servico-form').addEventListener('submit', salvarServico);

        // Inicialização
        document.addEventListener('DOMContentLoaded', function() {
            showSection('dashboard');
            carregarClientes();
            carregarServicos();
        });

        // Funções para mostrar/esconder seções e modais (mantendo as suas)
        function showSection(section) {
            document.querySelectorAll('.section').forEach(el => {
                el.classList.add('hidden');
            });
            document.getElementById(`${section}-section`).classList.remove('hidden');
        }
        window.showSection = showSection;

        function showModal(type) {
            document.getElementById(`${type}-modal`).classList.remove('hidden');
            if (type === 'cliente') {
                document.getElementById('cliente-modal-title').textContent = 'Novo Cliente';
                document.getElementById('cliente-form').reset();
                document.getElementById('cliente-id').value = '';
            } else if (type === 'servico') {
                document.getElementById('servico-modal-title').textContent = 'Novo Serviço';
                document.getElementById('servico-form').reset();
                document.getElementById('servico-id').value = '';
            }
        }
        function hideModal(type) {
            document.getElementById(`${type}-modal`).classList.add('hidden');
        }
        window.showModal = showModal;
        window.hideModal = hideModal;
    </script>
</body>
</html>